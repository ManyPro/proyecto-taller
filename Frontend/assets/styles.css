/* Centrar imagen/video en el modal de vista previa */
.viewer-modal { display: flex; align-items: center; justify-content: center; height: 100%; }
/* Botones de icono para thumbs en edición de ítem */
.thumb-btn-wrap { display: flex; align-items: center; gap: 6px; margin: 10px 0; }
.thumb-label { font-size: 14px; color: #cbd5e1; margin-right: 8px; }
.thumb-icon-btn { background: none; border: none; padding: 2px 4px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; transition: background .15s; }
.thumb-icon-btn:hover { background: #f3f4f6; }
:root{
  /* Paleta base (tema oscuro actual) */
  --bg:#0f172a;         /* fondo general */
  --card:#111827;       /* tarjetas/paneles */
  --card-alt:#0b1220;   /* variante inputs / headers */
  --text:#e5e7eb;       /* texto base */
  --text-invert:#0f172a;/* texto sobre superficies claras */
  --muted:#9ca3af;      /* texto secundario */
  --accent:#2563eb;     /* botones/activos */
  --accent-hover:#1d4ed8;
  --danger:#ef4444;     /* acciones destructivas */
  --border:#1f2937;     /* líneas / bordes */
  --input-bg:#0b1220;   /* fondo inputs */
  --scroll-track:#0b1220;
  --scroll-thumb:#334155;
  --focus-ring:0 0 0 2px rgba(37,99,235,.5);
  --shadow-elev:0 10px 35px rgba(0,0,0,.45);
  --table-head:#0b1220;
  --badge-bg:rgba(0,0,0,.66);
  --header-bg:linear-gradient(90deg,#0f172a,#152033); /* barra superior */
  --tab-bg:var(--card-alt);
  --tab-border:var(--border);
  --tab-bg-active:var(--accent);
  --tab-text:#ffffff;
  --tab-text-active:#ffffff;
  --sales-tab-bg:var(--card-alt);
  --sales-tab-bg-active:#1e293b;
  --sales-tab-text:var(--text);
  --sales-tab-text-active:#1e293b;
  --highlight-bg:rgba(37,99,235,.12); /* para filas o capsulas seleccionadas */
  --added-row-bg:rgba(56,189,248,.10); /* items ya agregados desde cotización */
  --added-row-border:rgba(56,189,248,.25);
  --sales-tab-border-active:#2563eb;
  --avatar-bg:#1e293b;
  --plate-chip-bg:#1e293b;
  --plate-chip-text:#ffffff;
  --inv-badge-bg:#065f46;        /* verde sutil oscuro */
  --inv-badge-text:#ecfdf5;
  --inv-badge-border:#10b98133;
  /* Badges adicionales (precio lista / servicio) */
  --price-badge-bg:#1d4ed8;      /* azul */
  --price-badge-text:#ffffff;
  --price-badge-border:#3b82f633;
--service-badge-bg:#92400e;    /* ámbar oscuro */
--service-badge-text:#fff7ed;
--service-badge-border:#f59e0b33;
}

.toggle{
  position:relative;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:14px;
  padding:12px 16px;
  border-radius:16px;
  border:1px solid rgba(148,163,184,.28);
  background:rgba(15,23,42,.38);
  color:inherit;
  cursor:pointer;
  transition:border-color .2s ease, background .2s ease, box-shadow .2s ease;
  user-select:none;
}
.toggle:hover{
  border-color:rgba(148,163,184,.45);
  box-shadow:0 6px 18px rgba(15,23,42,.28);
}
.toggle .toggle-text{
  font-size:.95rem;
  letter-spacing:.03em;
  text-transform:capitalize;
}
.toggle input{
  position:absolute;
  inset:0;
  opacity:0;
  cursor:pointer;
  margin:0;
}
.toggle .toggle-slider{
  pointer-events:none;
  width:46px;
  height:26px;
  border-radius:15px;
  background:rgba(100,116,139,.45);
  position:relative;
  transition:background .18s ease, box-shadow .18s ease;
  box-shadow:inset 0 0 0 1px rgba(15,23,42,.35);
}
.toggle .toggle-slider::after{
  content:'';
  position:absolute;
  width:20px;
  height:20px;
  border-radius:50%;
  background:#e2e8f0;
  top:3px;
  left:3px;
  transition:transform .18s ease, background .18s ease, box-shadow .18s ease;
  box-shadow:0 2px 6px rgba(15,23,42,.35);
}
.toggle input:checked + .toggle-slider{
  background:linear-gradient(90deg,#34d399,#10b981);
  box-shadow:0 0 0 2px rgba(16,185,129,.35);
}
.toggle input:checked + .toggle-slider::after{
  transform:translateX(20px);
  background:#ecfdf5;
  box-shadow:0 2px 8px rgba(16,185,129,.35);
}
body.theme-light .toggle{
  background:rgba(236,240,247,.85);
  border-color:rgba(148,163,184,.35);
  box-shadow:none;
}
body.theme-light .toggle:hover{
  border-color:rgba(100,116,139,.55);
}
body.theme-light .toggle .toggle-slider{
  background:rgba(148,163,184,.35);
  box-shadow:inset 0 0 0 1px rgba(15,23,42,.08);
}
body.theme-light .toggle input:checked + .toggle-slider{
  box-shadow:0 0 0 2px rgba(16,185,129,.25);
}
.toggle.disabled{
  opacity:.55;
  cursor:not-allowed;
}

/* Tema claro: se aplica añadiendo body.theme-light */
body.theme-light{
  --bg:#f5f7fb;
  --card:#ffffff;
  --card-alt:#f1f5f9;
  --text:#1f2937;
  --text-invert:#ffffff;
  --muted:#64748b;
  --accent:#2563eb;
  --accent-hover:#1d4ed8;
  --danger:#dc2626;
  --border:#d0d7e2;
  --input-bg:#ffffff;
  --scroll-track:#e2e8f0;
  --scroll-thumb:#94a3b8;
  --focus-ring:0 0 0 2px rgba(37,99,235,.35);
  --table-head:#f1f5f9;
  --badge-bg:#2563eb;
  --shadow-elev:0 6px 20px rgba(0,0,0,.15);
  --header-bg:linear-gradient(90deg,#ffffff,#f1f5f9);
  --tab-bg:#f1f5f9;
  --tab-border:#d9e0e9;
  --tab-bg-active:#2563eb;
  --tab-text:#334155;
  --tab-text-active:#ffffff;
  --sales-tab-bg:#f1f5f9;
  --sales-tab-bg-active:#dbe4ee;
  --sales-tab-text:#334155;
  --sales-tab-text-active:#1e293b;
  --highlight-bg:rgba(37,99,235,.13);
  --added-row-bg:rgba(56,189,248,.18);
  --added-row-border:rgba(2,132,199,.45);
  --sales-tab-border-active:#2563eb;
  --avatar-bg:#d8e2ec;
  --plate-chip-bg:#1e293b; /* fondo oscuro para placa en claro */
  --plate-chip-text:#ffffff;
  --inv-badge-bg:#047857;        /* verde para modo claro */
  --inv-badge-text:#ecfdf5;
  --inv-badge-border:#05966966;
  --price-badge-bg:#1d4ed8;
  --price-badge-text:#ffffff;
  --price-badge-border:#2563eb55;
  --service-badge-bg:#b45309;
  --service-badge-text:#fff7ed;
  --service-badge-border:#f59e0b55;
}

/* ===== Base ===== */
*{ box-sizing:border-box; }
html,body{ min-height:100%; }
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
  background:var(--bg);
  color:var(--text);
  transition:background .25s ease,color .25s ease;
}
.hidden{ display:none; }

header{
  display:flex; justify-content:space-between; align-items:center;
  padding:16px 24px; border-bottom:1px solid var(--border);
  background:var(--header-bg);
  backdrop-filter:blur(4px);
}
h1{ margin:0; font-size:20px; }
main{ padding:16px; max-width:1100px; margin:0 auto; }
footer{ text-align:center; color:var(--muted); padding:20px; }

/* ===== Inicio (Login) ===== */
#loginSection{ max-width: 560px; margin: 40px auto; padding: 0 16px; }
#loginSection > h2{ margin: 10px 0; }
#loginSection .card{ margin-top: 10px; }

/* ===== Componentes ===== */
.card{
  background:var(--card);               /* adaptable tema */
  border:1px solid var(--border);
  border-radius:12px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:var(--shadow-elev);
  transition:background .25s ease, border-color .25s ease, box-shadow .25s ease;
}

label{
  display:block; font-size:12px; color:var(--muted); margin-top:8px;
}

input,select,textarea{
  width:100%; padding:10px; border-radius:10px;
  border:1px solid var(--border); background:var(--input-bg); color:var(--text);
  transition:background .25s ease, color .25s ease, border-color .25s ease;
  pointer-events: auto !important;
  user-select: text !important;
  z-index: 1;
  position: relative;
}
input:focus,select:focus,textarea:focus{ 
  outline:none; box-shadow:var(--focus-ring);
  pointer-events: auto !important;
  user-select: text !important;
  z-index: 100;
}
textarea{ resize:vertical; }

button{
  background:var(--accent); color:var(--text-invert); border:0;
  padding:10px 14px; border-radius:10px; cursor:pointer; margin-top:10px; line-height:1.1;
  transition:background .2s ease, color .2s ease, border-color .2s ease, box-shadow .2s ease;
}
button:hover{ background:var(--accent-hover); }
button.secondary{ background:transparent; color:var(--text); border:1px solid var(--border); }
button.secondary:hover{ background:var(--card-alt); }
button.danger{ background:var(--danger); }
button:focus{ outline:none; box-shadow:var(--focus-ring); }

.row{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.grid-2{ display:grid; grid-template-columns:1fr 1fr; gap:16px; }
.span-2{ grid-column:1 / -1; }

@media (max-width:900px){
  .grid-2{ grid-template-columns:1fr; }
}

/* ===== Tabs de la app ===== */
.tabs{ display:flex; gap:6px; margin-bottom:12px; }
.tabs button{ background:var(--tab-bg); border:1px solid var(--tab-border); color:var(--tab-text); transition:background .18s ease, color .18s ease, border-color .18s ease; }
.tabs button.active{ background:var(--tab-bg-active); color:var(--tab-text-active); border-color:var(--tab-bg-active); box-shadow:0 0 0 1px rgba(0,0,0,.18),0 0 0 3px rgba(255,255,255,.04) inset; }
.tabs button:not(.active):hover{ background:var(--highlight-bg); }

/* ===== Secciones (show/hide) ===== */
.tab{ display:none; }
.tab.active{ display:block; }
.tab[hidden]{ display:none !important; }

/* ===== Notas – Filtros ===== */
#notes-filters .filters-bar{
  display:grid; grid-template-columns:1.2fr 1fr 1fr auto; gap:12px; align-items:end;
}
#notes-filters .filters-bar .field label{ margin-top:0; }
#notes-filters .filters-bar .apply-field button{ margin-top:0; }
@media (max-width:900px){ #notes-filters .filters-bar{ grid-template-columns:1fr; } }

/* ===== Inventario ===== */
#inventory-top{ display:grid; grid-template-columns:1fr 1fr; gap:16px; align-items:stretch; }
#inventory-top .card{ height:100%; }
#vi-card-lista{ min-height:420px; }

/* Tarjeta de ítem en inventario */
#itemsList .list-item{
  display:grid; grid-template-columns:1fr 2fr auto; gap:16px; align-items:center;
  padding:16px; border:1px solid rgba(255,255,255,.06); border-radius:12px; margin-bottom:12px;
}
.it-gallery{ display:flex; gap:8px; flex-wrap:wrap; }
.it-gallery img{
  width:96px; height:96px; object-fit:cover; border-radius:8px; border:1px solid rgba(255,255,255,.08);
}
.viewer img, .viewer video { max-width:200px; height:auto; border-radius:8px; margin:18px auto 0 auto; box-shadow:0 2px 4px rgba(0,0,0,.3); border:1px solid var(--border); cursor:pointer; display:block; transition:box-shadow .2s; }
.viewer img:hover, .viewer video:hover { box-shadow:0 4px 16px rgba(0,0,0,.28); }
.item-media img { max-width:200px; height:auto; border-radius:8px; margin:6px 6px 0 0; box-shadow:0 2px 4px rgba(0,0,0,.3); border:1px solid var(--border); }
.item-media video { max-width:260px; border-radius:8px; margin:6px 6px 0 0; }
.it-qr{ display:flex; flex-direction:column; align-items:center; gap:6px; }
.it-qr img{
  width:140px; height:140px; image-rendering:pixelated; border-radius:8px; background:#fff;
  padding:6px; border:1px solid rgba(255,255,255,.12);
}
.it-qr-actions{ display:flex; gap:8px; }
.it-text .it-title{ font-weight:700; margin-bottom:6px; }
.it-text .it-line span{ opacity:.75; }

/* Galería genérica de medios */
.item-media{ display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:8px; margin-top:8px; }
.item-thumb{
  width:100%; aspect-ratio:1/1; object-fit:cover; border-radius:10px; border:1px solid #1f2937; background:#0b1220;
  cursor:zoom-in; transition:transform .15s ease;
  pointer-events:auto;
  user-select:none;
}
.item-thumb:hover{ transform:scale(1.02); }

/* ===== Fix para inputs después de imágenes ===== */
.item-media + input,
.item-media + textarea,
.item-media + select,
.item-media ~ input,
.item-media ~ textarea,
.item-media ~ select {
  pointer-events: auto !important;
  user-select: text !important;
  z-index: 10;
  position: relative;
  touch-action: manipulation;
}

/* ===== Lista de stickers ===== */
.sticker-toolbar{ gap:10px; align-items:center; margin-top:8px; }
.sticker-check{ display:inline-flex; gap:8px; align-items:center; font-size:13px; color:var(--muted); }
.sticker-check input[type="checkbox"]{ width:18px; height:18px; accent-color:var(--accent); }

/* ===== Notas – tarjeta y badge de placa ===== */
.note{ border:1px solid var(--border); border-radius:10px; padding:12px; background:var(--card-alt); }
.note .actions{ margin-top:8px; }
.note .plate{
  --plate-color:#6d28d9;
  display:inline-block; padding:3px 10px; border:2px solid var(--plate-color);
  color:#fff; background:var(--badge-bg); border-radius:9999px; font-weight:800; letter-spacing:.5px; margin-bottom:8px;
}

/* ===== Tablas genéricas ===== */
.table-wrap{ overflow:auto; }
.table{ width:100%; border-collapse:collapse; font-size:14px; }
.table th,.table td{ border:1px solid var(--border); padding:8px; }
.table th{ background:var(--table-head); position:sticky; top:0; z-index:1; }
.table input,.table select{ width:100%; }

/* ===== Modal global ===== */
#modal.modal{
  position:fixed; inset:0; display:none; align-items:center; justify-content:center; padding:24px;
  background:rgba(2,6,23,.55); backdrop-filter:blur(4px); z-index:10000;
}
#modal.modal:not(.hidden){ display:flex; }
#modal .modal-content{
  position:relative; width:min(800px,100%); max-height:85vh; overflow:auto;
  background:var(--card); border:1px solid var(--border); border-radius:14px; padding:16px; box-shadow:var(--shadow-elev);
  transition:background .25s ease, border-color .25s ease, box-shadow .25s ease;
}
#modal .close{
  position:absolute; top:8px; right:8px; background:transparent; border:0; color:#cbd5e1;
  font-size:22px; line-height:1; width:32px; height:32px; border-radius:8px; cursor:pointer;
}
#modal .close:hover{ background:#0b1220; }

/* ===== Cotizaciones ===== */
#q-summary{ overflow:auto; scrollbar-width:thin; scrollbar-color:#334155 #0b1220; }
#q-summary::-webkit-scrollbar{ width:8px; }
#q-summary::-webkit-scrollbar-track{ background:var(--scroll-track); border-radius:8px; }
#q-summary::-webkit-scrollbar-thumb{ background:var(--scroll-thumb); border-radius:8px; border:2px solid var(--scroll-track); }
#q-summary .q-no{ margin:0 0 8px 0; font-size:1rem; }
#q-summary .q-no strong{ font-size:1.2rem; font-weight:700; }

/* Ítems en tarjetas (2 cols) */
.q-grid-2cols{ display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:16px; }
@media (max-width:900px){ .q-grid-2cols{ grid-template-columns:1fr; } }
.tr.q-row-card, .q-row-card{
  display:flex !important; flex-direction:column !important; gap:8px; padding:12px;
  border:1px solid var(--border); border-radius:10px; background:var(--card-alt);
  transition:background .25s ease,border-color .25s ease;
}
.q-row-card>div{ width:100%; }
.q-row-card .small input{ text-align:right; }
#q-items-card .totals{ display:flex; gap:16px; flex-wrap:wrap; margin-top:6px; }

/* Historial de cotizaciones */
#q-history-card .row.wrap{ margin:6px 0 12px; }
.q-history-list{ display:flex; flex-direction:column; gap:8px; max-height:420px; overflow:auto; }
.qh-item{
  display:grid; grid-template-columns:110px 1fr 120px 120px auto; gap:8px; align-items:center;
  padding:10px; border:1px solid var(--border); border-radius:10px; background:var(--card-alt);
}
.qh-item .meta{ color:var(--muted); font-size:12px; }
.qh-item .actions{ display:flex; gap:6px; justify-content:flex-end; }

/* ===== Lista de precios ===== */
#tab-precios{ overflow-x:auto; }
#tab-precios table.table{ min-width:1280px; border-collapse:separate; border-spacing:0; }
#tab-precios th, #tab-precios td{ white-space:nowrap; padding:6px 8px; }
#tab-precios td input{ height:28px; padding:2px 6px; font-size:.95rem; border-radius:8px; text-transform:none; }
#tab-precios td input[type="number"]{ width:8ch; min-width:6ch; max-width:12ch; text-align:right; }
#tab-precios thead th{ position:sticky; top:0; z-index:1; }
#tab-precios td:first-child, #tab-precios th:first-child{ position:sticky; left:0; z-index:2; background:inherit; }

/* ===== Ventas – layout (dos columnas) ===== */
.ventas-grid{ display:grid; grid-template-columns:420px minmax(420px,1fr); gap:14px; }
@media (max-width:1024px){ .ventas-grid{ grid-template-columns:1fr; } }

.ventas-left .table-wrap.small table.table th,
.ventas-left .table-wrap.small table.table td{ font-size:12px; padding:6px; }

/* Pestañas de ventas (cada venta abierta) */
.sales-tab{ padding:6px 12px; border-radius:14px; background:var(--sales-tab-bg); cursor:pointer; color:var(--sales-tab-text); border:1px solid var(--tab-border); font-size:12.5px; letter-spacing:.3px; font-weight:500; display:inline-flex; align-items:center; gap:4px; transition:background .22s ease,color .22s ease,border-color .22s ease, box-shadow .22s ease; }
.sales-tab:hover{ background:var(--highlight-bg); }
.sales-tab.active{
  background:var(--sales-tab-bg-active);
  color:var(--text);
  border-color:var(--sales-tab-border-active);
  box-shadow:0 0 0 1px var(--sales-tab-border-active), 0 2px 5px -2px rgba(0,0,0,.4);
  font-weight:600;
}

/* Filas marcadas como agregadas desde cotización → venta */
#sv-q-body tr.added{ background:var(--added-row-bg); border-left:4px solid var(--added-row-border); }
#sv-q-body tr.added td{ opacity:.97; }
.sales-tab .close{ margin-left:6px; opacity:.8; cursor:pointer; }

.avatar{ width:42px; height:42px; border-radius:50%; background:var(--avatar-bg); display:inline-flex; align-items:center; justify-content:center; color:var(--text); font-weight:600; font-size:14px; }
.plate.chip{ display:inline-block; background:var(--plate-chip-bg); padding:4px 12px; border-radius:999px; color:var(--plate-chip-text); font-weight:700; letter-spacing:.5px; box-shadow:0 0 0 1px rgba(255,255,255,.05),0 2px 4px rgba(0,0,0,.25); }
.cols-2{ display:grid; grid-template-columns:1fr 1fr; }
.cols-2 .col>input{ width:100%; }
.t-center{ text-align:center; }

/* ===== Ventas – pickers (Inventario / Lista de Precios) ===== */
.picker-head{
  display:grid; grid-template-columns:1fr 1fr auto; gap:8px; align-items:end; margin-bottom:8px;
}
@media (max-width:900px){ .picker-head{ grid-template-columns:1fr; } }
.picker-table table{ min-width:980px; }
.picker-actions{ display:flex; justify-content:space-between; align-items:center; margin-top:8px; }
.table .thumb{ width:44px; height:44px; object-fit:cover; border-radius:6px; display:inline-block; }
.table .thumb-qr{ width:44px; height:44px; object-fit:contain; background:#111; border-radius:6px; cursor:pointer; }
.w-fit{ white-space:nowrap; }

/* ===== Ventas – lector QR ===== */
.qrbar{ justify-content:space-between; margin-bottom:8px; }
.qrwrap{ position:relative; background:#0d1117; border-radius:8px; padding:8px; display:flex; justify-content:center; }
.qrwrap video{ width:100%; max-height:320px; border-radius:6px; background:#000; }
.qrwrap .qr-hud{ position:absolute; inset:8px; border:2px dashed rgba(255,255,255,.2); border-radius:6px; pointer-events:none; }
.qr-history{ margin-top:6px; max-height:120px; overflow:auto; font-size:.9rem; opacity:.8; }

/* ===== Utilidades ===== */
.sr-only{
  position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0);
  white-space:nowrap; border:0;
}
.t-right{ text-align:right; }
.muted{ color:var(--muted); }

/* ===== Badges de origen (ventas) ===== */
.inv-badge{
  display:inline-block; font-size:10px; letter-spacing:.5px; font-weight:600; padding:2px 6px; border-radius:6px;
  background:var(--inv-badge-bg); color:var(--inv-badge-text); border:1px solid var(--inv-badge-border);
  vertical-align:middle; line-height:1.1; margin-right:4px;
}
.sale-row-inventory td{ position:relative; }
.sale-row-inventory td:first-child{ box-shadow:inset 3px 0 0 0 var(--inv-badge-bg); }
/* Price list rows */
.sale-row-price td:first-child{ box-shadow:inset 3px 0 0 0 var(--price-badge-bg); }
/* Service rows */
.sale-row-service td:first-child{ box-shadow:inset 3px 0 0 0 var(--service-badge-bg); }

/* Badges de origen adicionales */
.price-badge, .service-badge{ display:inline-block; font-size:10px; letter-spacing:.5px; font-weight:600; padding:2px 6px; border-radius:6px; vertical-align:middle; line-height:1.1; margin-right:4px; }
.price-badge{ background:var(--price-badge-bg); color:var(--price-badge-text); border:1px solid var(--price-badge-border); }
.service-badge{ background:var(--service-badge-bg); color:var(--service-badge-text); border:1px solid var(--service-badge-border); }

/* Forgot password link */
.forgot-wrapper{ margin-top:8px; text-align:right; }
.forgot-link{ font-size:12px; text-decoration:none; color:var(--accent); opacity:.9; transition:color .2s ease, opacity .2s ease; }
.forgot-link:hover{ opacity:1; text-decoration:underline; }

/* ===== Ventas – cápsulas nuevas ===== */
.capsules-bar{ padding:12px 16px; }
.sale-capsule{
  background:var(--card-alt); border:1px solid var(--border); border-radius:14px; padding:10px 12px; min-width:150px; max-width:210px; position:relative;
  display:flex; flex-direction:column; gap:4px; cursor:pointer; transition:background .2s ease,border-color .2s ease, box-shadow .2s ease;
}
.sale-capsule:hover{ background:var(--highlight-bg); }
.sale-capsule.active{ border-color:var(--accent); box-shadow:0 0 0 1px var(--accent),0 4px 12px -4px rgba(0,0,0,.4); }
.sale-capsule .sc-top{ display:flex; justify-content:space-between; align-items:center; font-size:12px; font-weight:600; letter-spacing:.5px; }
.sale-capsule .sc-plate{ background:var(--plate-chip-bg); color:var(--plate-chip-text); padding:2px 8px; border-radius:999px; font-size:11px; }
.sale-capsule .sc-close{ background:transparent; border:0; color:var(--muted); font-size:14px; cursor:pointer; padding:0 4px; line-height:1; }
.sale-capsule .sc-close:hover{ color:var(--text); }
.sale-capsule .sc-tech{ font-size:11px; color:var(--muted); min-height:14px; }
.sale-capsule .sc-total{ font-size:13px; font-weight:600; text-align:right; }
.sale-capsule .sc-veh{ font-size:11px; line-height:1.2; color:var(--muted); min-height:22px; }
.fullwidth-bar{ width:100%; }
.capsules-wrap{ width:100%; }

/* ================= Responsive Enhancements (Appended) ================= */
/* Typography scaling */
html{ font-size:16px; }
@media (max-width:900px){ html{ font-size:15px; } }
@media (max-width:640px){ html{ font-size:14.5px; } }
@media (max-width:480px){ html{ font-size:14px; } }

/* Sticky topbar – global (desktop + mobile) */
.topbar {
  position: sticky;
  top: 0;
  z-index: 1000;
  background: var(--header-bg);
  backdrop-filter: saturate(120%) blur(6px);
  box-shadow: 0 4px 18px rgba(0,0,0,.35);
}
.topbar-inner{
  max-width: 1200px;
  margin: 0 auto;
  padding: 12px 16px; /* default desktop padding */
}
.topbar-card{
  background: var(--card-alt);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 12px 14px; /* default desktop spacing */
}
.brand{ display:flex; align-items:center; gap:10px; }
.brand img{ width:32px; height:32px; border-radius:6px; display:block; }
.brand h1{ margin:0; font-size:18px; }
.brand .company{ font-size:12px; opacity:.85; }
.top-tabs{ margin-top:8px; }
.top-tabs .tabs{ margin:0; }

/* Header & main adjustments */
@media (max-width:900px){
  header{ padding:12px 16px; }
  .topbar-inner{ padding: 10px 14px 12px 14px; }
  .topbar-card{ padding: 10px 12px; }
  .brand img{ width:26px; height:26px; }
  h1{ font-size:18px; }
  main{ padding:12px 10px; }
}
@media (max-width:640px){
  header{ flex-wrap:wrap; gap:8px; }
  h1{ flex:1 0 100%; text-align:center; }
  #authBox{ width:100%; display:flex; justify-content:space-between; }
}

/* Scrollable tabs on narrow screens */
@media (max-width:900px){
  .tabs{ overflow:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none; }
  .tabs::-webkit-scrollbar{ display:none; }
  .tabs button{ flex:0 0 auto; }
}

/* Inventory section single column below 900px (already for .grid-2, ensure inventory-top) */
@media (max-width:900px){ #inventory-top{ grid-template-columns:1fr; } }

/* Modal full screen mobile */
@media (max-width:640px){
  #modal.modal{ padding:0; }
  #modal .modal-content{ width:100%; height:100%; max-height:none; border-radius:0; padding:16px 14px 60px; }
  #modal .close{ top:10px; right:10px; }
}

/* Sales grid tighter gap on small */
@media (max-width:640px){ .ventas-grid{ gap:10px; } }

/* Capsules horizontal scroll */
@media (max-width:900px){
  .capsules-bar{ overflow:auto; -webkit-overflow-scrolling:touch; white-space:nowrap; }
  .capsules-bar::-webkit-scrollbar{ display:none; }
  .sale-capsule{ display:inline-flex; vertical-align:top; }
}

/* Table compaction for mobile */
@media (max-width:640px){
  .table th, .table td{ padding:6px 6px; }
  .table{ font-size:13px; }
}

/* Form & spacing adjustments */
@media (max-width:640px){
  .row{ gap:6px; }
  input,select,textarea{ padding:9px; }
  button{ padding:9px 12px; }
}

/* Responsive utility classes */
.hide-mobile{ display:initial !important; }
@media (max-width:640px){ .hide-mobile{ display:none !important; } }
.show-mobile{ display:none !important; }
@media (max-width:640px){ .show-mobile{ display:initial !important; } }
.horizontal-scroll{ overflow:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none; }
.horizontal-scroll::-webkit-scrollbar{ display:none; }

/* XS refinements */
@media (max-width:480px){
  .tabs button{ padding:8px 10px; font-size:12px; }
  .card{ padding:14px 14px 16px; }
  #notes-filters .filters-bar{ gap:8px; }
  .sale-capsule{ min-width:140px; padding:8px 10px; }
  .qh-item{ grid-template-columns:90px 1fr 90px 90px auto; }
}

/* ===== FAB (botón flotante) ===== */
#app-fab{ position:fixed; bottom:18px; right:18px; z-index:12000; display:flex; flex-direction:column; align-items:flex-end; gap:10px; }
#app-fab #fab-main{ background:var(--accent); color:var(--text-invert); width:54px; height:54px; border-radius:50%; font-size:26px; box-shadow:0 6px 18px rgba(0,0,0,.45); }
#app-fab #fab-menu{ display:flex; flex-direction:column; gap:8px; }
#app-fab #fab-menu button{ background:var(--card); border:1px solid var(--border); color:var(--text); padding:8px 12px; margin-top:0; font-size:13px; border-radius:10px; box-shadow:0 4px 14px rgba(0,0,0,.4); }

/* ===== Sticky action bar dentro de modales en móvil ===== */
@media (max-width:640px){
  #modal .modal-content .sticky-actions{ position:fixed; left:0; right:0; bottom:0; background:rgba(15,23,42,.92); backdrop-filter:blur(6px); padding:10px 14px; display:flex; gap:8px; justify-content:flex-end; border-top:1px solid var(--border); z-index:10100; }
  body.theme-light #modal .modal-content .sticky-actions{ background:rgba(255,255,255,.92); }
  #modal .modal-content{ padding-bottom:90px; }
}

/* ===== Colapsables (marcador) ===== */
h3.collapsed, h4.collapsed{ opacity:.85; }
h3.collapsed::after, h4.collapsed::after{ content:''; }

/* ===== Lazy images default (aplicar a img con loading=lazy) ===== */
img[loading="lazy"]{ filter:blur(0px); transition:filter .4s ease; }

/* ===== Tabla -> Cards (mobile) ===== */
@media (max-width:560px){
  .mobile-as-cards .table{ border:0; }
  .mobile-as-cards .table thead{ display:none; }
  .mobile-as-cards .table tr{ display:block; background:var(--card-alt); border:1px solid var(--border); border-radius:12px; padding:10px 12px; margin-bottom:10px; }
  .mobile-as-cards .table td{ display:flex; justify-content:space-between; border:0; padding:4px 0; font-size:13px; }
  .mobile-as-cards .table td::before{ content:attr(data-label); font-weight:600; color:var(--muted); margin-right:12px; }
}

/* ===== Dense mode ===== */
body.dense .table th, body.dense .table td{ padding:4px 6px; }
body.dense button{ padding:6px 10px; }
body.dense input, body.dense select, body.dense textarea{ padding:6px 8px; }
body.dense .card{ padding:12px 12px 14px; }

/* ===== Inventario: tarjetas ===== */
.inv-item-header{ display:flex; gap:12px; align-items:flex-start; margin-bottom:10px; }
.inv-checkbox{ display:inline-flex; }
.inv-checkbox input{
  appearance:none;
  width:22px;
  height:22px;
  border-radius:8px;
  border:2px solid var(--border);
  background:var(--card-alt);
  cursor:pointer;
  transition:all .2s ease;
  display:inline-flex;
  align-items:center;
  justify-content:center;
}
.inv-checkbox input:hover{ border-color:var(--accent); }
.inv-checkbox input:focus-visible{ outline:var(--focus-ring); }
.inv-checkbox input:checked{
  background:var(--accent);
  border-color:var(--accent);
  box-shadow:0 0 0 2px rgba(37,99,235,.25);
  color:#fff;
}
.inv-checkbox input:checked::after{
  content:'✓';
  font-size:12px;
  line-height:1;
}
.inv-item-info{ display:flex; flex-direction:column; gap:4px; }
.inv-item-name{ font-weight:700; font-size:1rem; color:var(--text); }
.inv-item-meta{ display:flex; flex-wrap:wrap; gap:10px; font-size:12px; color:var(--muted); }
.inv-item-meta span{ display:flex; align-items:center; gap:4px; }
.inv-item-meta span::before{ content:'•'; opacity:.6; }
.inv-item-meta span:first-child::before{ content:''; display:none; }

/* ===== Selección de stickers ===== */
.chip-button{
  background:rgba(37,99,235,.12);
  border:1px solid rgba(37,99,235,.5);
  color:var(--text);
  padding:6px 14px;
  border-radius:999px;
  font-size:13px;
  display:inline-flex;
  align-items:center;
  gap:6px;
  cursor:pointer;
  transition:all .2s ease;
}
.chip-button:hover{
  background:var(--accent);
  border-color:var(--accent);
  color:#fff;
}
.chip-button:focus-visible{ outline:var(--focus-ring); }
.chip-button .chip-icon{ font-size:12px; line-height:1; }

/* ===== Template builder (modo amigable) ===== */
#tpl-visual-editor.friendly-builder{
  border:1px solid var(--border);
  border-radius:12px;
  background:var(--card-alt);
  padding:16px;
}
#tpl-visual-editor .builder-grid{
  display:flex;
  flex-wrap:wrap;
  gap:18px;
}
#tpl-visual-editor .builder-main{
  flex:1 1 420px;
  display:flex;
  flex-direction:column;
  gap:16px;
}
#tpl-visual-editor .builder-side{
  flex:1 1 260px;
  display:flex;
  flex-direction:column;
  gap:14px;
}
#tpl-visual-editor .builder-step{
  background:var(--card);
  border:1px dashed rgba(148,163,184,.3);
  border-radius:12px;
  padding:14px;
  display:flex;
  flex-direction:column;
  gap:12px;
}
#tpl-visual-editor .builder-step-title{
  font-weight:700;
  font-size:15px;
  color:var(--text);
}
#tpl-visual-editor .builder-buttons{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:10px;
}
#tpl-visual-editor .builder-btn{
  background:var(--card-alt);
  border:1px solid var(--border);
  border-radius:10px;
  padding:10px 12px;
  font-size:13px;
  font-weight:600;
  color:var(--text);
  cursor:pointer;
  transition:all .2s ease;
  text-align:center;
}
#tpl-visual-editor .builder-btn:hover,
#tpl-visual-editor .builder-btn:focus-visible{
  background:var(--accent);
  border-color:var(--accent);
  color:#fff;
  box-shadow:0 8px 20px rgba(37,99,235,.25);
  outline:none;
}
#tpl-visual-editor .builder-btn.danger{
  background:rgba(239,68,68,.12);
  border-color:rgba(239,68,68,.4);
  color:var(--danger);
}
#tpl-visual-editor .builder-btn.danger:hover,
#tpl-visual-editor .builder-btn.danger:focus-visible{
  background:var(--danger);
  color:#fff;
  border-color:var(--danger);
  box-shadow:0 8px 20px rgba(239,68,68,.25);
}
#tpl-visual-editor .builder-canvas{
  min-height:240px;
  background:#fff;
  border:2px dashed rgba(148,163,184,.45);
  border-radius:12px;
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:10px;
  color:#1f2937;
}
body.theme-light #tpl-visual-editor .builder-canvas{
  color:#111827;
}
#tpl-visual-editor .vblock{
  background:#ffffff;
  border:1px solid rgba(148,163,184,.45);
  border-radius:8px;
}
#tpl-visual-editor .helper-card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  padding:14px;
  display:flex;
  flex-direction:column;
  gap:10px;
  box-shadow:0 6px 18px rgba(15,23,42,.25);
}
#tpl-visual-editor .friendly-vars{
  display:flex;
  flex-direction:column;
  gap:12px;
}
#tpl-visual-editor .var-group{
  display:flex;
  flex-direction:column;
  gap:6px;
}
#tpl-visual-editor .var-title{
  font-weight:600;
  font-size:12px;
  color:var(--muted);
  letter-spacing:.3px;
  text-transform:uppercase;
}
#tpl-visual-editor .var-items{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}
#tpl-visual-editor .var-pill{
  background:var(--card-alt);
  border:1px dashed rgba(148,163,184,.45);
  border-radius:999px;
  padding:6px 12px;
  font-size:12px;
  cursor:pointer;
  color:var(--text);
  transition:all .2s ease;
}
#tpl-visual-editor .var-pill:hover,
#tpl-visual-editor .var-pill:focus-visible{
  background:var(--accent);
  border-color:var(--accent);
  color:#fff;
  outline:none;
  box-shadow:var(--focus-ring);
}
#tpl-visual-editor.builder-disabled{
  pointer-events:none;
  user-select:none;
  filter:saturate(.3) brightness(.85);
}
#tpl-visual-editor.builder-disabled::after{
  content:'Modo experto activo (HTML)';
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:14px;
  font-weight:600;
  color:var(--text);
  background:rgba(15,23,42,.75);
  border-radius:12px;
  text-transform:uppercase;
  letter-spacing:.6px;
}
#tpl-visual-editor{ position:relative; }

/* ===== Fix específico para inputs en editor de templates ===== */
#tab-formatos input,
#tab-formatos textarea,
#tab-formatos select {
  pointer-events: auto !important;
  user-select: text !important;
  z-index: 10 !important;
  position: relative !important;
}

#tab-formatos input:focus,
#tab-formatos textarea:focus,
#tab-formatos select:focus {
  z-index: 100 !important;
  pointer-events: auto !important;
  user-select: text !important;
}

/* Asegurar que los bloques del canvas no interfieran con inputs */
.vblock {
  pointer-events: auto;
  position: relative;
}

.vblock input,
.vblock textarea,
.vblock select {
  pointer-events: auto !important;
  user-select: text !important;
  z-index: 20 !important;
}

/* Fix global para todos los inputs de texto después de cualquier elemento */
input:not([type="file"]):not([type="checkbox"]):not([type="radio"]):not([type="button"]):not([type="submit"]):not([type="reset"]),
textarea,
select {
  pointer-events: auto !important;
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  -ms-user-select: text !important;
  cursor: text !important;
  touch-action: manipulation !important;
}

/* Reglas específicas para cuando están en focus */
input:focus:not([type="file"]):not([type="checkbox"]):not([type="radio"]):not([type="button"]):not([type="submit"]):not([type="reset"]),
textarea:focus,
select:focus {
  pointer-events: auto !important;
  user-select: text !important;
  z-index: 999 !important;
}

/* Fix para elementos que pueden tener eventos de arrastre */
[draggable="true"] input,
[draggable="true"] textarea,
[draggable="true"] select {
  pointer-events: auto !important;
  user-select: text !important;
  z-index: 30 !important;
}

/* Prevenir que las imágenes interfieran */
img + input,
img + textarea,
img + select,
.item-thumb + input,
.item-thumb + textarea,
.item-thumb + select {
  pointer-events: auto !important;
  user-select: text !important;
  z-index: 25 !important;
}


