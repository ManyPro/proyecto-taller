<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>M&M - Editor de Plantillas</title>
  <link rel="stylesheet" href="assets/styles.css?v=20250923-2">
  <link rel="stylesheet" href="assets/css/pages/template-editor.css?v=20250923-2">
  <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
</head>
<body data-page="formatos">
  <header class="app-header" id="appHeader">
    <div class="row between" style="align-items:center;gap:8px;flex-wrap:wrap;">
      <div class="row" style="gap:10px;align-items:center;">
        <h1 style="margin:0;font-size:18px;">Taller App</h1>
  <div class="muted" style="font-size:12px;">Empresa: <span id="companyName">-</span> (<span id="companyEmail">-</span>)</div>
      </div>
      <div class="row" style="gap:6px;align-items:center;">
        <button id="logoutBtn" class="secondary hidden">Salir</button>
  <button id="themeToggle" class="secondary" title="Cambiar tema">🌗</button>
      </div>
    </div>
  </header>

  <main>
    <section id="appSection" class="hidden">
      <nav class="tabs">
  <button data-tab="home" data-href="index.html">Inicio</button>
  <button data-tab="notas" data-href="notas.html">Notas</button>
  <button data-tab="ventas" data-href="ventas.html">Ventas</button>
  <button data-tab="cotizaciones" data-href="cotizaciones.html">Cotizaciones</button>
  <button data-tab="inventario" data-href="inventario.html">Inventario</button>
  <button data-tab="precios" data-href="precios.html">Lista de precios</button>
  <button data-tab="cashflow" data-href="cashflow.html">Flujo de Caja</button>
  <button data-tab="reporte-tecnico" data-href="reporte-tecnico.html">Reporte Técnico</button>
  <button data-tab="formatos" data-href="template-selector.html" class="active">Formatos</button>
  <button data-tab="skus" data-href="skus.html">SKUs</button>
      </nav>

      <!-- MODAL GLOBAL -->
      <div id="modal" class="modal hidden">
        <div class="modal-content">
          <button id="modalClose" class="close">&times;</button>
          <div id="modalBody">
            <div id="modal-img-wrap" style="display:flex;justify-content:center;align-items:center;flex-direction:column;">
              <img id="modal-img" src="" alt="Vista previa" style="max-width:90vw;max-height:90vh;width:1200px;height:auto;transition:transform 0.2s;" />
              <div style="margin-top:12px;display:flex;gap:8px;">
                <button id="zoom-in" class="secondary">+</button>
                <button id="zoom-out" class="secondary">-</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="template-editor-container">
    <div class="editor-main">
      <h1 style="margin: 0 0 2rem 0; font-size: 2rem; font-weight: 700;">🎨 Editor de Plantillas Visual</h1>
      
      <div id="custom-editor">
        <div id="ce-toolbar" class="ce-toolbar"></div>
        <div id="ce-canvas" class="ce-canvas" contenteditable="false"></div>
      </div>
      
      <div class="template-actions">
        <button id="save-template">
          💾 Guardar Plantilla
        </button>
        <button id="preview-template">
          👀 Vista Previa
        </button>
        <button onclick="window.location.href='template-selector.html'">
          ⬅️ Volver al Menú
        </button>
      </div>
    </div>
    
    <aside class="editor-sidebar">
      <h3>Variables disponibles</h3>
      <div id="var-list"></div>
      <h3>Presets</h3>
      <div id="preset-list" style="color: #999; font-style: italic;">
        (Próximamente)
      </div>
    </aside>
  </div>
  
  <script src="./assets/js/config.js"></script>
  <script src="assets/js/api.js"></script>
  <script src="assets/js/templates-visual.js"></script>
    <!-- Overlay de vista previa no utilizado; mantenido por compatibilidad -->
    <div id="preview-overlay" style="display:none;position:fixed;inset:0;background:rgba(2,6,23,.6);z-index:9999;align-items:center;justify-content:center;padding:40px;">
      <div style="background:var(--card);border:1px solid var(--border);width:80%;height:80%;border-radius:12px;display:flex;flex-direction:column;box-shadow:var(--shadow-elev);">
        <div style="padding:10px 14px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;">
          <strong style="font-size:14px;">Vista previa</strong>
          <button id="preview-close" class="secondary">Cerrar</button>
        </div>
        <iframe id="preview-frame" style="flex:1;width:100%;border:0;background:var(--card);"></iframe>
      </div>
    </div>
    </section>
  </main>

  <script type="module" src="./assets/js/app.js" charset="utf-8"></script>
  <script src="./assets/js/input-fix.js"></script>
</body>
</html>
